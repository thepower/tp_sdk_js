# ThePower SDK JavaScript libraries.

### Описание

Описание API можно найти по адресу: [https://github.com/thepower/api_doc/wiki](https://github.com/thepower/api_doc/wiki)

### Быстрый старт

Чтобы собрать и использовать The Power SDK выполните следующие команды:

```
git clone https://github.com/thepower/tp_sdk_js.git
cd tp_sdk_js
git submodule init
git submodule update
npm install
npm run build
```

В папке tp_sdk_js/build лежит файл tp-sdk.min.js. Этот файл можно подключить на веб страницу.
После этого будет доступен объект tpSdk.

Так же, для создания транзакций необходимо чтобы файл js-sha512/sha512.min.js был доступен по ссылке '/sha512.min.js'.

Реализованы следующие методы:

- register

Предназначен для регистрации новой учётной записи.

```js
async register(email, password, authAddress, chain)
```

Принимаемые параметры

email - адрес электронной почты. Используется как логин.

password - пароль для учётной записи.

authAddress - адрес СК для авторизации.

chain - номер шарда, в котором находится СК авторизации.

После регистрации учётной записи данный метод асинхронно вернёт объект со следующими полями:

address - адрес зарегистрированной учётной записи.

encWIF - строка с приватным ключом в зашифрованном виде (зашифрован при помощи переданого пароля). 

- login

Предназначен для авторизации в учётной записи.

```js
async login(email, password, authAddress, chain)
```

Принимаемые параметры

email - адрес электронной почты. Используется как логин.

password - пароль для учётной записи.

authAddress - адрес СК для авторизации.

chain - номер шарда, в котором находится СК авторизации.

После авторизации данный метод асинхронно вернёт объект со следующими полями:

address - адрес учётной записи.

encWIF - строка с приватным ключом в зашифрованном виде (зашифрован при помощи переданого пароля). 

- decryptWif

Предназначен для расшифровки зашифрованного приватного ключа.

```js
decryptWif(encrypted, password)
```

Принимаемые параметры

encrypted - строка с зашифрованным приватным ключом.

password - пароль для расшифровки приватного ключа.

Данный метод возвращает строку с расшифрованным приватным ключом (в виде wif).

- packAndSignTX

Предназначен для упаковки и подписывания транзакции.

```js
packAndSignTX(tx, wif)
```

Принимаемые параметры

tx - объект, содержащий сфоромированную транзакцию.

wif - расшифрованный приватный ключ.

Данный метод возвращает упакованную и подписанную транзакцию в виде base64.

- loadFeeSettings

Предназначен для асинхронного получения настроек шарда. Настройки используются при формировании транзакций.

```js
async loadSettings(chain)
```

Принимаемые параметры

chain - номер шарда, из которого запрашиваются настройки.

Данный метод асинхронно возвращает объект с настройками шарда.

- composeSCMethodCallTX

Предназначен для формирования транзакции, вызывающей метод удалённого СК.

```js
composeSCMethodCallTX(address, sc, toCall, wif, settings)
```

Принимаемые параметры

address - адрес учётной записи.

sc - адрес СК, содержащего вызываемый метод.

toCall - массив, содержащий данные о вызываемом методе и его параметрах. Вида ['имя_метода', [параметры]].

wif - расшифрованный приватный ключ.

settings - объект, содержащий настройки шарда.

Данный метод возвращает упакованную и подписанную транзакцию в виде base64.

- sendTxAndWaitForResponse

Предназначен для формирования транзакции, вызывающей метод удалённого СК.

```js
sendTxAndWaitForResponse(tx, timeout)
```

Принимаемые параметры

tx - упакованная и подписанная транзакция в виде base64.

timeout - максимальное время ожидания результата в миллисекундах. По-умолчанию 120000.

Данный метод возвращает Promise, который, в случае успеха вернёт информацию о созданной и выполненной
транзакции или, в случае сбоя или истечения максимального времени выполнения, - ошибку.

